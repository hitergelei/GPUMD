.. _kw_ensemble_shock_nemd:

:attr:`ensemble` (NEMD shock methods)
=====================================

In a typical NEMD shock simulation, a shock wave is generated by a moving *wall*.
The *wall* can be simulated in multiple ways:

- :attr:`wall_piston`: A fixed layer of atoms.
- :attr:`wall_mirror`: A momentum mirror that reflects atoms.
- :attr:`wall_harmonic`: A harmonic potential that pushes atoms away. It is softer than a momentum mirror.

Any of these methods can generate a shock wave. While there are other possible methods, the above methods are usually sufficient.

Please note that the shock wave propagates in the *x*-direction.
Another wall is placed on the opposite side of the cell to prevent atoms from escaping.
It is important **NOT** to use non-periodic boundary conditions in the *x*-direction, as GPUMD currently does not handle it well. A vacuum layer is automatically added on the other side of the cell.

It is recommended to use this with the :ref:`dump_shock_nemd keyword <kw_dump_shock_nemd>` to get the spatial distribution of thermo information.

Syntax
------

The parameters are specified as follows:

.. code-block:: rst

    ensemble wall_piston vp <vp> thickness <thickness>

- :attr:`<vp>`: Indicates the velocity of the moving piston in km/s.
- :attr:`<thickness>`: Defines the thickness of the wall in Angstroms. This keyword is optional with the default value of 20.

.. code-block:: rst

    ensemble wall_mirror vp <vp>

- :attr:`<vp>`: Indicates the velocity of the moving piston in km/s.

.. code-block:: rst

    ensemble wall_harmonic vp <vp> k <k>

- :attr:`<vp>`: Indicates the velocity of the moving piston in km/s.
- :attr:`<k>`: Defines the strength of the harmonic wall in eV/A^2. This keyword is optional with the default value of 10.