

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Force constant potential &mdash; GPUMD  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=ddb61244" />

  
    <link rel="shortcut icon" href="../_static/logo.ico"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Neuroevolution potential" href="nep.html" />
    <link rel="prev" title="Angular Dependent Potential (ADP)" href="adp.html" />
    <meta name="twitter:card" content="summary" />

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            GPUMD
              <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Main</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory/index.html">Theoretical background</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Interatomic potentials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tersoff_1988.html">Tersoff potential (1988)</a></li>
<li class="toctree-l2"><a class="reference internal" href="tersoff_1989.html">Tersoff potential (1989)</a></li>
<li class="toctree-l2"><a class="reference internal" href="tersoff_mini.html">Tersoff mini-potential</a></li>
<li class="toctree-l2"><a class="reference internal" href="lennard_jones.html">Lennard-Jones potential</a></li>
<li class="toctree-l2"><a class="reference internal" href="eam.html">Embedded atom method</a></li>
<li class="toctree-l2"><a class="reference internal" href="adp.html">Angular Dependent Potential (ADP)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Force constant potential</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#potential-form">Potential form</a></li>
<li class="toctree-l3"><a class="reference internal" href="#file-format">File format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#driver-file">driver file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#force-constant-files">force constant files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#equilibrium-position-file">equilibrium position file</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="nep.html">Neuroevolution potential</a></li>
<li class="toctree-l2"><a class="reference internal" href="nep_ilp.html">Hybrid NEP+ILP potential</a></li>
<li class="toctree-l2"><a class="reference internal" href="sw_ilp.html">Hybrid SW+ILP potential</a></li>
<li class="toctree-l2"><a class="reference internal" href="tersoff_ilp.html">Hybrid Tersoff+ILP potential</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Interface</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../gpumd/index.html">gpumd executable</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nep/index.html">nep executable</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Backmatter</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GPUMD</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div style="text-align: right;">
<a href="https://github.com/brucefan1983/GPUMD" target="_blank">source repo</a>
| <a href="https://gpumd.org/" target="_blank">gpumd.org</a>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="force-constant-potential">
<span id="index-0"></span><span id="fcp"></span><h1>Force constant potential<a class="headerlink" href="#force-constant-potential" title="Link to this heading"></a></h1>
<p>The force constant potential (<a class="reference internal" href="../glossary.html#term-FCP"><span class="xref std std-term">FCP</span></a>) is obtained through a systematic expansion of the energy in displacements as described <a class="reference internal" href="../bibliography.html#brorsson2021" id="id1"><span>[Brorsson2021]</span></a>.</p>
<section id="potential-form">
<h2>Potential form<a class="headerlink" href="#potential-form" title="Link to this heading"></a></h2>
<p>In the force constant potential, the potential energy is calculated as a Taylor expansion in terms of the atomic displacements <span class="math notranslate nohighlight">\(\{u_i^{a}\}\)</span> relative to a set of reference (equilibrium) positions as</p>
<div class="math notranslate nohighlight">
\[U = U_2 + U_3 + U_4 + U_5 + U_6 + \cdots\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\begin{split}U_2 &amp;= \frac{1}{2!} \sum_{ij}     \sum_{ab}     \Phi_{ij}^{ab}         u_{i}^{a} u_{j}^{b} \\
U_3 &amp;= \frac{1}{3!} \sum_{ijk}    \sum_{abc}    \Phi_{ijk}^{abc}       u_{i}^{a} u_{j}^{b} u_{k}^{c} \\
U_4 &amp;= \frac{1}{4!} \sum_{ijkl}   \sum_{abcd}   \Phi_{ijkl}^{abcd}     u_{i}^{a} u_{j}^{b} u_{k}^{c} u_{l}^{d} \\
U_5 &amp;= \frac{1}{5!} \sum_{ijklm}  \sum_{abcde}  \Phi_{ijklm}^{abcde}   u_{i}^{a} u_{j}^{b} u_{k}^{c} u_{l}^{d} u_{m}^{e} \\
U_6 &amp;= \frac{1}{6!} \sum_{ijklmn} \sum_{abcdef} \Phi_{ijklmn}^{abcdef} u_{i}^{a} u_{j}^{b} u_{k}^{c} u_{l}^{d} u_{m}^{e} u_{n}^{f}.\end{split}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\Phi_{ij}^{ab}\)</span>, <span class="math notranslate nohighlight">\(\Phi_{ijk}^{abc}\)</span>, <span class="math notranslate nohighlight">\(\Phi_{ijkl}^{abcd}\)</span>, <span class="math notranslate nohighlight">\(\Phi_{ijklm}^{abcde}\)</span>, and <span class="math notranslate nohighlight">\(\Phi_{ijklmn}^{abcdef}\)</span> are the second-order, third-order, fourth-order, fifth-order, and sixth-order force constants.
The indices <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span>, <span class="math notranslate nohighlight">\(k\)</span>, <span class="math notranslate nohighlight">\(l\)</span>, <span class="math notranslate nohighlight">\(m\)</span>, and <span class="math notranslate nohighlight">\(n\)</span> refer to the atoms and can take integer values from 0 to <span class="math notranslate nohighlight">\(N-1\)</span>, where <span class="math notranslate nohighlight">\(N\)</span> is the number of atoms in the system.
The indices <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(c\)</span>, <span class="math notranslate nohighlight">\(d\)</span>, <span class="math notranslate nohighlight">\(e\)</span>, and <span class="math notranslate nohighlight">\(f\)</span> refer to the axes in the Cartesian coordinate system and can take integer values 0, 1, and 2, which correspond to the <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(z\)</span> axes, respectively.
In <strong class="program">GPUMD</strong>, we only consider force constants up to sixth order.</p>
</section>
<section id="file-format">
<h2>File format<a class="headerlink" href="#file-format" title="Link to this heading"></a></h2>
<p>One needs to prepare several files related to this potential, which can be conveniently generated using the <a class="reference external" href="https://hiphive.materialsmodeling.org/">hiphive package</a> <a class="reference internal" href="../bibliography.html#eriksson2019" id="id2"><span>[Eriksson2019]</span></a>, except for the driver potential file below (which is very easy to prepare).</p>
<section id="driver-file">
<h3>driver file<a class="headerlink" href="#driver-file" title="Link to this heading"></a></h3>
<p>The driver potential file for this potential model reads:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fcp</span> <span class="n">number_of_atom_types</span> <span class="o">&lt;</span><span class="nb">list</span> <span class="n">of</span> <span class="n">atom</span> <span class="n">symbols</span><span class="o">&gt;</span>
<span class="n">highest_force_order</span> <span class="n">highest_heat_current_order</span>
<span class="n">path_to_force_constant_files</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">fcp</span></code> is the name of this potential and tells the code that we are using the force constant potential.</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">number_of_atom_types</span></code> is the number of atom types defined in the <a class="reference internal" href="../gpumd/input_files/model_xyz.html#model-xyz"><span class="std std-ref">simulation model file</span></a>.</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">&lt;list</span> <span class="pre">of</span> <span class="pre">atom</span> <span class="pre">symbols&gt;</span></code> is a list of all the elements in the potential (can be in any order).</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">highest_force_order</span></code> is the highest order of the force constants used in the potential.
For example, when <code class="xref py py-attr docutils literal notranslate"><span class="pre">highest_order</span></code> is 4, second-order, third-order, and fourth-order forces constants will be used (and should be prepared).</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">highest_heat_current_order</span></code> is the highest order of the force constants used for heat current calculations.
It can only be 2 or 3, which means using the second order force constants only or using both the second and third order force constants for heat current calculations, respectively.</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">path_to_force_constant_files</span></code> is the path to the force constant files (see below).
<strong>Important:</strong> There should be no trailing slash (<code class="docutils literal notranslate"><span class="pre">/</span></code>) after the folder name.</p></li>
</ul>
</section>
<section id="force-constant-files">
<h3>force constant files<a class="headerlink" href="#force-constant-files" title="Link to this heading"></a></h3>
<p>The force constant data should be prepared in some files named:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clusters_order2</span><span class="o">.</span><span class="ow">in</span>
<span class="n">clusters_order3</span><span class="o">.</span><span class="ow">in</span>
<span class="n">clusters_order4</span><span class="o">.</span><span class="ow">in</span>
<span class="n">clusters_order5</span><span class="o">.</span><span class="ow">in</span>
<span class="n">clusters_order6</span><span class="o">.</span><span class="ow">in</span>
<span class="n">fcs_order2</span><span class="o">.</span><span class="ow">in</span>
<span class="n">fcs_order3</span><span class="o">.</span><span class="ow">in</span>
<span class="n">fcs_order4</span><span class="o">.</span><span class="ow">in</span>
<span class="n">fcs_order5</span><span class="o">.</span><span class="ow">in</span>
<span class="n">fcs_order6</span><span class="o">.</span><span class="ow">in</span>
</pre></div>
</div>
<p>These files should be in the folder you specified in the driver potential file (see above).
If you only consider force constants up to the 4th order, you do not need the files with numbers 5 and 6.
These files can be generated by the <a class="reference external" href="https://hiphive.materialsmodeling.org/moduleref/io.html#input-and-output">hiphive package</a>.
Here, we therefore do not describe the formats of these files.</p>
</section>
<section id="equilibrium-position-file">
<h3>equilibrium position file<a class="headerlink" href="#equilibrium-position-file" title="Link to this heading"></a></h3>
<p>Because this potential is defined in terms of the atomic displacements, one has to define the equilibrium (reference) positions of the atoms in the system.
A file called <code class="docutils literal notranslate"><span class="pre">r0.in</span></code> is used for this purpose.
This file should be in the folder you specified in the driver potential file (see above).
The format of this file is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_0</span> <span class="n">y_0</span> <span class="n">z_0</span>
<span class="n">x_1</span> <span class="n">y_1</span> <span class="n">z_1</span>
<span class="n">x_2</span> <span class="n">y_2</span> <span class="n">z_2</span>
<span class="n">x_3</span> <span class="n">y_3</span> <span class="n">z_3</span>
<span class="o">...</span>
</pre></div>
</div>
<p>where each line gives the position of one atom.
The order of the atoms should be consistent with that in the <a class="reference internal" href="../gpumd/input_files/model_xyz.html#model-xyz"><span class="std std-ref">simulation model file</span></a>.
The coordinates are in units of Ångstrom.
This file is also generated by the <a class="reference external" href="https://hiphive.materialsmodeling.org/moduleref/io.html#input-and-output">hiphive package</a>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="adp.html" class="btn btn-neutral float-left" title="Angular Dependent Potential (ADP)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="nep.html" class="btn btn-neutral float-right" title="Neuroevolution potential" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
    <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Documentation</span>
      v4.2
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="https://gpumd.org">latest release</a></dd>
        
          <dd><a href="https://gpumd.org/dev">development version</a></dd>
        
      </dl>
    </div>
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

<script>
    (function() {
      if (!localStorage.getItem('cookieconsent')) {
        var banner = document.createElement("div");
        banner.innerHTML ='\
        <div class="cookieconsent" style="position:fixed;padding:18px;left:0;bottom:0;background-color:#121212;color:#FFF;text-align:center;width:100%;z-index:99999;">\
          This website uses cookies to gather general statistics about its usage. \
          <a href="#" style="font-size: 90%; border-radius: 5px; background-color: #CCCCCC; padding: 2px 7px; margin-left: 1em; color:black;">Hide</a>\
        </div>';
        document.body.appendChild(banner);
        document.querySelector('.cookieconsent a').onclick = function(e) {
          e.preventDefault();
          document.querySelector('.cookieconsent').style.display = 'none';
          localStorage.setItem('cookieconsent', true);
        };
      }
    })();
</script>


</body>
</html>