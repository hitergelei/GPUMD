# LAMMPS input for ADP verification
# Generate reference data for comparison with GPUMD

# Initialize
units metal
dimension 3
boundary p p p
atom_style atomic
read_data  Mo_structs_0.dat


# Use the same ADP potential
pair_style adp
#pair_coeff * * Mo.adp Mo
pair_coeff * *  ../../adp_U_Mo/U_Mo.alloy.adp_cor.txt  Mo
#pair_coeff * * ../../adp_U_Mo/U_Mo.alloy.adp_cor_nowuw.txt  Mo
#pair_coeff * * ../../adp_U_Mo/U_Mo.alloy.adp_cor_noz2r.txt Mo

# Set same temperature as GPUMD test
#velocity all create 300.0 12345
velocity all create 0.0001 12345

compute eng all pe/atom
compute eatoms all reduce sum c_eng
# Compute per-atom potential energy
compute pe all pe/atom

# Run and dump the same configuration
timestep 0.001
fix 1 all nve

neighbor  0  bin



thermo 1
thermo_style custom step etotal pe lx ly lz press pxx pyy pzz c_eatoms

# Dump forces, energies for first step
dump 1 all custom 1 lammps_adp_reference.dump id element type x y z fx fy fz c_pe
dump_modify  1 element Mo sort id
# Run for 1 step to match GPUMD test
run 0

# Additional information
print "LAMMPS ADP reference data generated"
print "Total energy: $(etotal)"
print "Potential energy: $(pe)"
print "Kinetic energy: $(ke)"

