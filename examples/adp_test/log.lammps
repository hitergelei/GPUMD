LAMMPS (29 Aug 2024 - Update 3)
# LAMMPS input for ADP verification
# Generate reference data for comparison with GPUMD

# Initialize
units metal
dimension 3
boundary p p p
atom_style atomic
read_data fcc_ni_no_vel.data
Reading data file ...
  orthogonal box = (5.748559e-08 5.748559e-08 5.748559e-08) to (7.0399999 7.0399999 7.0399999)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  32 atoms
  read_data CPU = 0.000 seconds

# Use the same ADP potential
pair_style adp
pair_coeff * * Ni.adp Ni
Reading adp potential file Ni.adp with DATE: 2011-06-20

# Set same temperature as GPUMD test
#velocity all create 300.0 12345
velocity all create 0.01 12345

# Run and dump the same configuration
timestep 0.001
fix 1 all nve

# Compute per-atom potential energy
compute pe all pe/atom

# Dump forces, energies for first step
dump 1 all custom 1 lammps_adp_reference.dump id type x y z fx fy fz c_pe

# Run for 1 step to match GPUMD test
run 1
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7.168
  ghost atom cutoff = 7.168
  binsize = 3.584, bins = 2 2 2
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair adp, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 5.776 | 5.776 | 5.776 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0.01          -142.4          0             -142.39996      0.12263945   
         1   0.0099821357  -142.4          0             -142.39996      0.12290018   
Loop time of 0.000163294 on 1 procs for 1 steps with 32 atoms

Performance: 529.107 ns/day, 0.045 hours/ns, 6123.924 timesteps/s, 195.966 katom-step/s
50.2% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 8.283e-05  | 8.283e-05  | 8.283e-05  |   0.0 | 50.72
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 4.256e-06  | 4.256e-06  | 4.256e-06  |   0.0 |  2.61
Output  | 7.0861e-05 | 7.0861e-05 | 7.0861e-05 |   0.0 | 43.39
Modify  | 2.168e-06  | 2.168e-06  | 2.168e-06  |   0.0 |  1.33
Other   |            | 3.179e-06  |            |       |  1.95

Nlocal:             32 ave          32 max          32 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           1067 ave        1067 max        1067 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           2240 ave        2240 max        2240 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 2240
Ave neighs/atom = 70
Neighbor list builds = 0
Dangerous builds = 0

# Additional information
print "LAMMPS ADP reference data generated"
LAMMPS ADP reference data generated
print "Total energy: $(etotal)"
Total energy: -142.39995992506791822
print "Potential energy: $(pe)"
Potential energy: -142.39999992412938923
print "Kinetic energy: $(ke)"
Kinetic energy: 3.999906146529022896e-05
Total wall time: 0:00:00
