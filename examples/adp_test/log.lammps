LAMMPS (29 Aug 2024 - Update 3)
# LAMMPS input for ADP verification
# Generate reference data for comparison with GPUMD

# Initialize
units metal
dimension 3
boundary p p p
atom_style atomic
read_data fcc_ni.data
Reading data file ...
  orthogonal box = (5.748559e-08 5.748559e-08 5.748559e-08) to (7.0399999 7.0399999 7.0399999)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  32 atoms
  reading velocities ...
  32 velocities
  read_data CPU = 0.001 seconds

# Use the same ADP potential
pair_style adp
pair_coeff * * Ni.adp Ni
Reading adp potential file Ni.adp with DATE: 2011-06-20

# Set same temperature as GPUMD test
velocity all create 300.0 12345

# Run and dump the same configuration
timestep 0.001
fix 1 all nve

# Compute per-atom potential energy
compute pe all pe/atom

# Dump forces, energies for first step
dump 1 all custom 1 lammps_adp_reference.dump id type x y z fx fy fz c_pe

# Run for 1 step to match GPUMD test
run 1
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7.168
  ghost atom cutoff = 7.168
  binsize = 3.584, bins = 2 2 2
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair adp, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 5.776 | 5.776 | 5.776 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300           -142.4          0             -141.19788      3680.0077    
         1   299.46508     -142.39785      0             -141.19788      3688.0452    
Loop time of 0.000238945 on 1 procs for 1 steps with 32 atoms

Performance: 361.589 ns/day, 0.066 hours/ns, 4185.064 timesteps/s, 133.922 katom-step/s
68.6% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.00012433 | 0.00012433 | 0.00012433 |   0.0 | 52.03
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 4.752e-06  | 4.752e-06  | 4.752e-06  |   0.0 |  1.99
Output  | 0.00010546 | 0.00010546 | 0.00010546 |   0.0 | 44.14
Modify  | 1.729e-06  | 1.729e-06  | 1.729e-06  |   0.0 |  0.72
Other   |            | 2.671e-06  |            |       |  1.12

Nlocal:             32 ave          32 max          32 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           1067 ave        1067 max        1067 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           2240 ave        2240 max        2240 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 2240
Ave neighs/atom = 70
Neighbor list builds = 0
Dangerous builds = 0

# Additional information
print "LAMMPS ADP reference data generated"
LAMMPS ADP reference data generated
print "Total energy: $(etotal)"
Total energy: -141.19787815111303075
print "Potential energy: $(pe)"
Potential energy: -142.39785402109774282
print "Kinetic energy: $(ke)"
Kinetic energy: 1.1999758699847213883
Total wall time: 0:00:00
